# Toy Domain Configuration
# 這是一個示例配置，展示如何自定義框架

domain_name: "toy_example"
description: "A minimal toy domain for framework testing"

# 1. Agent 角色與權限
agent_roles:
  decision_maker:
    interfaces:
      - ReadInterface
      - ActionRequestInterface
    allowed_actions:
      - do_nothing
      - adapt
      - buy_insurance

  auditor:
    interfaces:
      - ReadInterface
    allowed_actions: []

# 2. 可觀察信號 (LLM 可讀取)
observable_signals:
  agent:
    - resources
    - threat_perception
    - vulnerability
    - last_action
    - memory
  environment:
    - risk_level
    - shock_occurred
    - step

# 3. 隱藏狀態 (LLM 不可見)
hidden_state:
  - seed
  - internal_counters
  - raw_probabilities

# 4. Action 目錄
action_catalog:
  do_nothing:
    description: "Take no action this step"
    cost: 0
    constraints: []
    
  adapt:
    description: "Reduce vulnerability, costs resources"
    cost: 30
    constraints:
      - "agent.resources >= 30"
    effects:
      vulnerability: "vulnerability * 0.5"
      
  buy_insurance:
    description: "Partial protection, moderate cost"  
    cost: 15
    constraints:
      - "agent.resources >= 15"
    effects:
      vulnerability: "vulnerability * 0.7"

# 5. 驗證器配置
validators:
  enabled:
    - SchemaValidator
    - PolicyValidator
    - FeasibilityValidator
    - LeakageValidator
    - MemoryIntegrityValidator
  
  # 領域特定驗證器
  domain_validators:
    - ToyTheoryValidator
  
  # 驗證順序
  order:
    - SchemaValidator
    - PolicyValidator
    - LeakageValidator
    - MemoryIntegrityValidator
    - FeasibilityValidator
    - ToyTheoryValidator

# 6. Retry 策略
retry_policy:
  max_retries: 2
  retry_on:
    - SchemaValidator
    - PolicyValidator
  fallback_action: do_nothing
  uncertain_on:
    - FeasibilityValidator
    - ToyTheoryValidator

# 7. 審計配置
audit:
  log_level: full  # full | summary | errors_only
  output_dir: "./audit_output"
  trace_fields:
    - run_id
    - step_id
    - timestamp
    - seed
    - agent_id
    - memory_pre
    - memory_post
    - llm_output
    - validator_results
    - action_request
    - admissible_command
    - execution_result
    - state_diff
    - outcome
  rotation:
    enabled: true
    max_entries_per_file: 10000

# 8. Replay 配置
replay:
  seed_management: deterministic
  capture_tool_responses: true
