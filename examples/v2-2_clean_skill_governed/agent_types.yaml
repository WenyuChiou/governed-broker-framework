# =============================================================================
# Agent Type Configuration for v2-2 Clean Experiment
# =============================================================================
# Single source of truth for agent configuration.
# This is experiment-specific, NOT the framework default.

household:
  description: "Household agents making flood adaptation decisions"
  
  # Domain Parameters (Simulation-specific)
  parameters:
    # No cost parameters in original v2 experiment
    tp_threshold_moderate: 0.05
    tp_threshold_high: 0.20
  
  # Audit Configuration
  audit:
    output_dir: "results"
    experiment_name: "v2-2_clean"
    log_prompt: true
    log_llm_response: true
  
  # Parsing Configuration
  parsing:
    decision_keywords: ["final decision:", "decision:", "decide:"]
    default_skill: "do_nothing"
  
  # Available Actions (mapped to skills)
  actions:
    - id: buy_insurance
      aliases: ["FI", "insurance"]
      description: "Purchase flood insurance"
    - id: elevate_house
      aliases: ["HE", "elevate", "elevation"]
      description: "Elevate house structure"
    - id: relocate
      aliases: ["RL", "move"]
      description: "Relocate to safer area"
    - id: do_nothing
      aliases: ["DN", "nothing", "wait"]
      description: "Take no action this year"
  
  # Validation Rules (PMT Coherence)
  coherence_rules:
    # If claimed "cannot afford" but chose expensive option
    financial_consistency:
      trigger_phrases: ["cannot afford", "too expensive", "no money"]
      blocked_skills: ["elevate_house", "relocate"]
      trigger_phrases: ["cannot afford", "too expensive", "no money"]
      blocked_skills: ["elevate_house", "relocate"]
      rejection_reason: "Claims financial constraint but chose expensive action"
    
    # Rule 1: High Threat + High Coping => Should NOT Do Nothing
    urgency_check:
      construct: TP
      state_field: flood_threshold # Proxy for susceptibility
      threshold: 0.7 # High threshold
      when_above: ["HIGH", "SEVERE"] # If label is High
      # Logic: Ideally this would check CP too, but for single construct rule:
      blocked_skills: ["do_nothing"] # Block Do Nothing if TP is High
      # Since our validator is exclusion-based or coherence-based, we can frame as:
      # If TP=High, should imply Action. 
      # Note: Current coherence engine is checking state->label. 
      # To check label->action, we might need 'blocked_skills' with label condition.
      # Simplified for now: standard coherence is State -> Label.
    
    # Rule 2: Low Threat => Should NOT Relocate
    overreaction_check:
      construct: TP
      threshold: 0.0 # Low state
      # If label is LOW
      trigger_phrases: ["low threat", "minimal risk", "safe"]
      blocked_skills: ["relocate"]
      message: "Claims low threat but chose extreme action (relocate)"

  # Simulation Constants
  simulation:
    memory_window: 5
    random_memory_recall_chance: 0.2
    grant_probability: 0.5
    num_agents_default: 100
  
  # Initial Memory Pool (Past Events)
  past_events:
    - "A flood event about 15 years ago caused $500,000 in city-wide damages; my neighborhood was not impacted at all"
    - "Some residents reported delays when processing their flood insurance claims"
    - "A few households in the area elevated their homes before recent floods"
    - "The city previously introduced a program offering elevation support to residents"
    - "News outlets have reported a possible trend of increasing flood frequency and severity in recent years"
