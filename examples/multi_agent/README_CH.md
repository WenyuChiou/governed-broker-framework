# 多代理基準測試 (Multi-Agent Benchmark)：社會與制度動態

本基準測試將框架擴展為 **多代理系統 (MAS)**，包含 50+ 個家庭代理人以及制度參與者（政府、保險公司），進行為期 10 年的互動模擬。

## 實驗設計

我們測試三種不同的配置，以分離 **社會互動 (Social Interaction)** 與 **記憶系統 (Memory Systems)** 的影響：

| 場景 (Scenario)                 | 記憶引擎        | 社會八卦 (Gossip) | 描述                                                                                                       |
| :------------------------------ | :-------------- | :---------------- | :--------------------------------------------------------------------------------------------------------- |
| **1. 孤立 (Isolated)**          | Window (Size=1) | ❌ 禁用           | **基準對照組**。代理人獨立行動，幾乎沒有記憶上下文。                                                       |
| **2. 窗口 (Window)**            | Window (Size=3) | ✅ 啟用           | **社會標準組**。代理人會分享推理過程（"為什麼我提高了房屋"），有效的社會認證（Social Proof）會進入記憶流。 |
| **3. 以人為本 (Human-Centric)** | Human-Centric   | ✅ 啟用           | **高級認知組**。使用重要性/新近性/相關性評分，即使在嘈雜的社會環境中也能保留關鍵記憶（如過去的洪水）。     |

## 關鍵特性

### 1. 制度代理人 (Institutional Agents)

與單一代理模擬不同，此環境包含動態的制度：

- **紐澤西州政府 (NJ State Government)**：根據預算和採納率調整 **補貼率 (Subsidy Rate)**。
- **FEMA/NFIP (保險機構)**：根據計畫的損失率 (Loss Ratio) 調整 **保險費率 (Premium Rate)**。
  - _影響_：代理人必須對不斷變化的經濟激勵做出反應（例如，保費上漲可能引發搬遷）。

### 2. 社會網絡 (八卦機制)

- **推理傳播**：當代理人做出決定（例如 "抬高房屋"）時，其 _推理過程_ 會廣播給鄰居（k=4 網絡）。
- **社會認證**：鄰居會收到這條記憶軌跡：_"鄰居 X 決定抬高房屋，因為 [理由]"_。這將影響他們隨後的威脅/應對評估。

### 3. 生命周期掛鉤 (Lifecycle Hooks)

- **年初 (Pre-Year)**：決定是否發生洪水 ($P=0.3$)，解決未完成的行動（例如，抬高房屋需要 1 年完成）。
- **步驟後 (Post-Step)**：更新制度的全局狀態（補貼/保費變更）。
- **年末 (Post-Year)**：計算洪水損害（影響情感記憶）並進行記憶整合。

## 如何執行

使用提供的 PowerShell 腳本在所有模型和場景中運行完整的基準測試：

```powershell
./examples/multi_agent/run_ma_benchmark.ps1
```

### 配置

- **代理人數量**：50 (業主/租戶混合)
- **年份**：10
- **模型**：Llama 3.2, Gemma 2, DeepSeek-R1 (可在腳本中配置)

## 輸出結構

結果將保存至 `examples/multi_agent/results_benchmark/`：

```
results_benchmark/
├── llama3_2_3b_isolated/
├── llama3_2_3b_window/
├── llama3_2_3b_humancentric/
...
```

每個文件夾包含：

- `simulation_log.csv`: 決策與行動日誌。
- `household_governance_audit.csv`: 感知與驗證日誌。
- `institutional_log.csv`: 政府/保險狀態變更日誌。
